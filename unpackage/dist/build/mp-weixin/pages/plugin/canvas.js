(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/plugin/canvas"],{"4dc3":function(t,e,n){"use strict";(function(t){n("9d04");s(n("66fd"));var e=s(n("aa86"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"6a0c":function(t,e,n){"use strict";n.r(e);var s=n("eaf0"),i=n.n(s);for(var o in s)"default"!==o&&function(t){n.d(e,t,(function(){return s[t]}))}(o);e["default"]=i.a},aa86:function(t,e,n){"use strict";n.r(e);var s=n("b659"),i=n("6a0c");for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);n("f06c");var c,a=n("f0c5"),l=Object(a["a"])(i["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],c);e["default"]=l.exports},b659:function(t,e,n){"use strict";var s;n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return s}));var i=function(){var t=this,e=t.$createElement;t._self._c},o=[]},b76b:function(t,e,n){},eaf0:function(t,e,n){"use strict";(function(t){var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={data:function(){return{cansWidth:375,cansHeight:375,sysWidth:375,sysHeight:375,widths:"",imgsrc:"",userdata:{},swiperList:[],my_qrcode:""}},onLoad:function(){n=this,n.swiperList=[{posterImg:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=1068316074,4162025599&fm=26&gp=0.jpg"},{posterImg:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2984198739,1466087350&fm=11&gp=0.jpg"},{posterImg:"https://b-ssl.duitang.com/uploads/item/201410/09/20141009224754_AswrQ.jpeg"}],t.getSystemInfo({success:function(t){console.log("systeminfo:"+JSON.stringify(t)),n.sysWidth=t.windowWidth,n.sysHeight=t.windowHeight,n.cansWidth=t.windowWidth,n.cansHeight=t.windowWidth,console.log("----------cansWidth:"+n.cansWidth)}}),n.selseimg(n.swiperList[0].posterImg),n.my_qrcode=t.getStorageSync("my_qrcode"),console.log("onLoad:"+n.my_qrcode)},methods:{selseimg:function(e){var s=this;t.showLoading({title:"生成海报中"});var i=t.createCanvasContext("firstCanvas");t.downloadFile({url:e,success:function(t){s.getImageInfo(e),i.drawImage(t.tempFilePath,0,0,s.cansWidth,s.cansHeight)}}),setTimeout((function(){i.drawImage(n.my_qrcode,s.cansWidth-85,s.cansHeight-85,75,75),i.setFillStyle("#333333"),i.setFontSize(12),i.fillText("我的邀请码",s.cansWidth-80,s.cansHeight-95),i.fill(),i.setFillStyle("#666666"),i.setFontSize(12),i.fillText("邀请你加入拾金，",(s.cansWidth-106)/2,s.cansHeight-50),i.fillText("手机就能赚钱！",(s.cansWidth-106)/2,s.cansHeight-30),i.fill(),i.restore(),i.draw(),t.hideLoading()}),1e3)},saveCans:function(e){t.showLoading({title:"保存海报中"}),console.log("保存");var s=1.5;t.canvasToTempFilePath({x:0,y:0,width:n.cansWidth*s,height:n.cansHeight*s,destWidth:n.cansWidth*s*2,destHeight:n.cansHeight*s*2,canvasId:"firstCanvas",success:function(s){t.hideLoading(),t.saveImageToPhotosAlbum({filePath:s.tempFilePath,success:function(i){t.showToast({title:"保存相册成功"}),n.imgsrc=s.tempFilePath,2==e&&(console.log("自己写分享"),t.share({provider:"weixin",scene:"WXSceneSession",type:2,imageUrl:s.tempFilePath,success:function(t){console.log("success:"+JSON.stringify(t))},fail:function(t){console.log("fail:"+JSON.stringify(t))}}))},fail:function(e){"saveImageToPhotosAlbum:fail auth deny"==e.errMsg&&t.showModal({title:"您需要授权相册权限",success:function(e){e.confirm&&t.openSetting({success:function(t){},fail:function(t){console.log(t)}})}})}})},fail:function(e){t.hideLoading()}},this)},getImageInfo:function(e){var n=this;return new Promise((function(s,i){t.getImageInfo({src:e,success:function(t){console.log("========getImageInfo:"+JSON.stringify(t)),n.cansHeight=n.sysWidth*t.height/t.width,console.log("----------cansHeight="+n.cansHeight),s(t)}})}))}}};e.default=s}).call(this,n("543d")["default"])},f06c:function(t,e,n){"use strict";var s=n("b76b"),i=n.n(s);i.a}},[["4dc3","common/runtime","common/vendor"]]]);